// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  id    Int     @id @default(autoincrement())
  email String  @unique
  name  String?
}

model Admin {
  id        String   @id @default(cuid())
  email     String   @unique
  password  String
  name      String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model SeoSetting {
  id          String   @id @default(cuid())
  pageRoute   String   @unique
  title       String?
  description String?  @db.Text
  keywords    String?  @db.Text
  schemaMarkup String?  @db.Text
  canonicalUrl String?
  robots      String?
  ogTitle     String?
  ogDescription String? @db.Text
  ogImage     String?
  twitterCard String?
  updatedAt   DateTime @updatedAt
}

model Query {
  id String @id @default(cuid())
  name String
  email String
  phone String?
  message String @db.Text
  status String @default("unread")
  createdAt DateTime @default(now())
}

model MailConfig {
  id String @id @default(cuid())
  host String
  port Int
  user String
  password String
  fromEmail String
  senderName String @default("Brent Linen") // New field
  adminEmail String @default("info@brentlinenhire.co.uk")
  
  // Templates
  adminSubject String @default("New Website Query from {{name}}")
  adminBody String? @db.Text // Use default code if null
  
  customerSubject String @default("We received your message - Brent Linen")
  customerBody String? @db.Text // Use default code if null

  // Booking Templates
  bookingAdminSubject String @default("New Booking Request from {{name}}")
  bookingAdminBody String? @db.Text

  bookingCustomerSubject String @default("Booking Confirmation - Brent Linen")
  bookingCustomerBody String? @db.Text

  updatedAt DateTime @updatedAt
}

model BookingCategory {
  id          String           @id @default(cuid())
  title       String
  imageRatio  String           @default("square") // "portrait", "square", "landscape"
  products    BookingProduct[]
  createdAt   DateTime         @default(now())
  updatedAt   DateTime         @updatedAt
}

model BookingProduct {
  id          String           @id @default(cuid())
  title       String
  description String?          @db.Text
  price       Float?
  quantity    Int?             @default(1)
  image       String?
  isActive    Boolean          @default(true)
  categoryId  String?
  category    BookingCategory? @relation(fields: [categoryId], references: [id])
  bookings    Booking[]
  createdAt   DateTime         @default(now())
  updatedAt   DateTime         @updatedAt
}

model Booking {
  id            String         @id @default(cuid())
  productId     String
  product       BookingProduct @relation(fields: [productId], references: [id])
  date          DateTime
  time          String
  customerName  String
  customerEmail String
  customerPhone String
  address       String
  address2      String?
  city          String
  zip           String
  endDate       DateTime?      // Optional end date for range
  endTime       String?        // Optional end time
  quantity      Int            @default(1)
  totalHours    Float?
  totalPrice    Float?
  status        String         @default("pending")
  createdAt     DateTime       @default(now())
  updatedAt     DateTime       @updatedAt
}
